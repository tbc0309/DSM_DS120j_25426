<!DOCTYPE html>
<html class="img-no-display">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

<link href="../../help.css" type="text/css" rel="stylesheet" />
<link href="../../scrollbar/flexcroll.css" type="text/css" rel="stylesheet" />
<script type="text/javascript" src="../../scrollbar/flexcroll.js"></script>
<script type="text/javascript" src="../../scrollbar/initFlexcroll.js"></script>
</head>
<body>

<h2>SSD キャッシュ</h2>
<p>SSD キャッシュは、頻繁にアクセスするデータを SSD キャッシュに保存することにより、ランダム アクセスの性能を高めることができます。SSD キャッシュはボリュームまたは iSCSI LUN（ブロックレベル）にマウントできます。</p>

<p>SSD キャッシュを有効にする目的は、ストレージ スペースで頻繁にアクセスする小さいデータ部分へのランダムアクセスの性能を高めることです。たとえば、大きいシーケンシャル読み書き操作（HD ビデオ ストリーミングなど）と、データのランダム読み取りパターン全体の両方には再読み取りパターンがないため、SSD キャッシングの利点をあまり受けません。一般的なアプリケーションでは、<b>[シーケンシャル I/O を省略する]</b> オプションを有効にして、シーケンシャル I/O がストレージ スペースのドライブにパススルーするようにします。</p>

<div class="section"><h4>注：</h4>
<ul>
	<li>SSD キャッシュは特定のモデルでのみ利用可能です。SSD キャッシュをサポートするモデルについては、<a href="https://www.synology.com/knowledgebase/DSM/tutorial/General/Which_Synology_NAS_models_support_SSD_cache" target="_blank">この記事</a>をご覧ください。</li>
	<li>Synology NAS で問題が発生するのを防ぐため、当社は互換性のあるドライブを SSD キャッシュとして選択することを推奨します。</li>
	<li>Synology NAS で使用できる SSD キャッシュの最大サイズについては、<a href="http://www.synology.com/" target=_blank>Synology のホームページ</a>でご使用モデルの製品仕様をご確認ください。</li>
</ul>
</div>

<h3>SSD キャッシュ タイプ</h3>
<p>SSD キャッシュには2つのタイプがあり、どちらも LRU (Least Recently Used) アルゴリズムを導入してキャッシュのデータを入れ替えます。</p>
<ul>
	<li><B>[読み取り専用キャッシュ]</B> は、基本的な構成か RAID 0 構成にそれぞれマウントできる 1 台から 12 台の SSD から構成され、それがマウントされているストレージ スペースのランダム読み取り速度を向上させます。</li>
	<li><B>[読み書きキャッシュ]</B> を RAID 1 / RAID 5 / RAID 6 構成にマウントして、SSD の数に応じて（最大 12 台のSSD）、それがマウントされているストレージ スペースのランダム読み書き速度を向上させます。</li>
</ul>

<div class="section"><h4>注：</h4>
<ul>
	<li>SSD 読み取り専用キャッシュは、ボリュームからデータのコピーを保存します。したがって、読み取り専用キャッシュがクラッシュしたとしても、データは消失しません。</li>
	<li>SSD の読み書きキャッシュが劣化した場合、<b>自動保護メカニズム</b>が有効化されます。これは、新しい IO のキャッシュを停止し、SSD から HDD に既存の新しいデータの書き込みを開始します (すなわち、同期)。データの同期が完了したら、読み書きキャッシュがクラッシュしたとしてもデータは消失しません。</li>
	<li>通常の状況では、SSD の読み書きキャッシュは、まだ HDD と同期していない新しいデータを含んでいます。Storage Manager からキャッシュを削除するまでは、(たとえシステムの電源がオフになっている場合であっても) Synology NASから SSD を取り外さないでください。そうでないと、ボリュームがクラッシュすることがあります。</li>
</ul>
</div>

<h3>メモリ要件</h3>
<p>メモリー要件は CPU of your Synology NAS の CPU によって異なります。どの CPU が Synology NAS で使用されているかを確かめるには、<a href="https://www.synology.com/knowledgebase/DSM/tutorial/General/What_kind_of_CPU_does_my_NAS_have" target="_blank">この記事</a>を参照してください。</p> 

<h4>Alpine CPU のモデルの場合：</h4>
	<p>1 GB の SSD キャッシュ毎に、約 416 KB のシステム メモリが必要です（拡張可能なメモリも数えられます）。最大キャッシュサイズは 930 GB です。要するに、読み取り専用のキャッシュが 128 GB SSD 2 台で構成されている場合は、合計のキャッシュサイズが 256 GB になり、最低でも 104 MB のメモリが必要になります。書き込み専用のキャッシュが 128 GB SSD 2 台で構成されている場合は、合計のキャッシュサイズが 128 GB になり、最低でも 52 MB のメモリが必要になります。メモリが不足している場合、SSD キャッシュの構築が制限されるか、SSD キャッシュのサイズが制限されます。</p>

<h4>その他のモデルの場合：</h4>
	<p>SSD キャッシュはキャッシュ サイズに応じて一定の量のシステム メモリを必要とします。そのため、大容量の SSD キャッシュを使用する場合は、Synology NAS のメモリをアップグレードする必要があるかもしれません。システムを安定させ、速度を維持するためには、SSD キャッシュに使用できるあらかじめ搭載されたシステム メモリはわずか 1/4 です。</p>
	
	<p>1 GB の SSD キャッシュ毎に、約 416 KB のシステム メモリが必要です（拡張可能なメモリも数えられます）。<br><span class="note_head">注：</span>これは、DSM 5.1 またはそれ以前のバージョンで作成された読み書き SSD キャッシュには該当しません。つまり、DSM 5.2 環境で使用していたとしても、DSM 5.2 以前のバージョンで作成された SSD キャッシュ 1 GB ごとに、4 MB のシステムメモリが必要となると言うことです。</p>
	
	<p>要するに、読み取り専用のキャッシュが 128 GB SSD 2 台で構成されている場合は、合計のキャッシュサイズが 256 GB になり、最低でも 104 MB のメモリが必要になります。書き込み専用のキャッシュが 128 GB SSD 2 台で構成されている場合は、合計のキャッシュサイズが 128 GB になり、最低でも 52 MB のメモリが必要になります。メモリが不足している場合、SSD キャッシュの構築が制限されるか、SSD キャッシュのサイズが制限されます。</p>

<h3>キャッシュのヒット率</h3>
<p>SSD キャッシュはデフォルトではランダム I/O だけを高速化し、シーケンシャル I/O は高速化しません。SSD キャッシュのキャッシュ ヒット率は次の式で計算できます。</p>
<ul>
	<li>SSD 読み取り専用のキャッシュのヒット率 = 高速化されたランダム読み取りカウント / 総ランダム読み取りカウント * 100%</li>
	<li>SSD 読み取り書き込みのキャッシュのヒット率 = 高速化されたランダム読み取り&書き込みカウント / 総ランダム読み取り&書き込みカウント * 100%</li>
</ul>

<h3>SSD キャッシュの管理</h3>
<h4>SSD キャッシュをマウントする：</h4>
	<ol>
	  <li>Synology NAS に SSD をインストールします。上記の注意をお読みください。</li>
	  <li><strong>[ストレージ マネージャ]</strong> > <strong>[SSD キャッシュ]</strong> を選択します。<b>[作成]</b> をクリックします。</li>
	<li>キャッシュ モードを選択します（読み書きキャッシュに対応するモデルでのみ使用できます）。</li>
	<li>ドロップダウン メニューで、SSD キャッシュをマウントしたいボリューム、または iSCSI LUN（ブロックレベル）を選択します。</li>
	<li>リストから SSD を選択します。SSD に保存されたデータは消去されますので、重要なデータが削除されないようにしてください。</li>
	<li><b>[適用]</b> をクリックします。</li>
	</ol>

<h4>シーケンシャル I/O のキャッシングを停止する： </h4>
	<p>ターゲット ボリュームまたは iSCSI LUN（ブロックレベル）のシーケンシャル I/O の性能が良い場合は、SSD キャッシュがシーケンシャル I/O をキャッシングするのを停止させて、ドライブから直接データにアクセスさせると、速度を上げ、性能を高めることができます。 </p>
	<ol>
	<li><strong>[構成]</strong> をクリックして構成ウィンドウを開きます。</li>
	<li><strong>[シーケンシャル I/O は省略する]</strong> にチェックマークを付けます。 </li>
	</ol>

<h4>SSD キャッシュを取り外す：</h4>
	<ol>
	<li><b>[削除]</b> をクリックすると、この SSD キャッシュを Synology NAS から完全に削除できます。</li>
	</ol>

<div class="section">
<h4>注：</h4>
<ul>
    <li>読み書きキャッシュの場合は、この手順で削除しなければ（Synology NAS の電源が切ってあったとしても）、キャッシュにしか部分データが存在しないため、ボリュームがクラッシュします。</li>
	<li>SSD キャッシュをマウント、または取り外すときには、システムは関連するサービスをすべて中断します（共有フォルダ、インストールされたパッケージ、現在の接続など。）</li>
	<li>ブートアップ時にストレージ スペースの読み書きキャッシュが検出されなければ、システムはそのストレージ スペースをマウントしません。Synology NAS で SSD を検出して再インストールし、ストレージ スペースをマウントするためにリブートしてください。</li>
	<li>関連の SSD を取り外す前に、読み書き SSD キャッシュを適切に削除するようにしてください。SSD を不適切に取り外すと（例：キャッシュが使用中またはシステムがオフになっているときなど）、ターゲット ボリュームまたは iSCSI LUN に保存されているデータがクラッシュします。
</ul>
</div>
 
<h4>SSD キャッシュの取り外しをキャンセルする方法：</h4> 
<ol>
    <li><b>[削除をキャンセル]</b> をクリックして、キャッシュを取り外す操作をキャンセルします。</li>
    </ol>    

<h4>SSD キャッシュを修復する：</h4>
	<ul>
		<li><strong>読み書きキャッシュ：</strong>SSD の 1 台がクラッシュした場合は、次の手順にしたがって修復してください。
		  <ol>
			<li>故障した SSD を新しいディスクと交換します。（新しい SSD は古い SSD と同じモデル、同じサイズでなければなりません。）</li>
			<li><b>[修復]</b> ボタンをクリックします。</li>
			<li>リストから SSD を選択します。</li>
			<li><b>[適用]</b> をクリックします。</li>
			</ol></li>
		<li><strong>読み取り専用キャッシュ：</strong>SSD の 1 つがクラッシュした場合は、キャッシュを取り外して故障した SSD を交換してください。次に、[<strong>作成</strong>] をクリックして新しいキャッシュを構築します。</li>
	</ul>

<h3>SSD キャッシュ アドバイザー</h3>
<p>この機能は、特定のボリューム上で最近アクセスしたファイルのサイズと数を計算し、表示します。選択したボリュームで SSD キャッシュが作成されていない場合は、この情報はご使用のシステムにどの程度の SSD キャッシュが適しているかを評価するときの参考情報となります。選択したボリュームにすでに SSD キャッシュが作成されている場合は、キャッシュ分析と使用量も表示されます。</p>

<h4>SSD キャッシュ アドバイザーを使う：</h4>
	<ol>
	<li><B>[SSD キャッシュ アドバイザー]</B> をクリックしてウィザードを起動します。</li>
	<li>計算するボリュームを選択し、<b>[次へ]</b> をクリックします。</li>
	<li>ウィザードが特定のボリューム上にある最近アクセスしたファイルのサイズと数の合計を計算し始めます。計算回数は、それぞれの環境によって異なります。</li>
	</ol>

/* Copyright (c) 2020 Synology Inc. All rights reserved. */

Ext.namespace("SYNO.SDS.App.EboxReassembleNotify");Ext.define("SYNO.SDS.App.EboxReassembleNotify.Instance",{extend:"SYNO.SDS.AppInstance",shouldNotifyMsg:function(a,b){var c=this;c.win.show();return false},initInstance:function(b){var a=this;if(!a.win){a.win=new SYNO.SDS.App.EboxReassembleNotify.Window({appInstance:a});a.addInstance(a.win);a.win.setTitle(_T("volume","ebox_space_crash_disk_enough_title"))}if(true===_S("is_ebox_reassemble_notify")){a.win.show()}},onOpen:function(b){var a=this;a.initInstance(b)}});Ext.define("SYNO.SDS.App.EboxReassembleNotify.Window",{extend:"SYNO.SDS.AppWindow",constructor:function(a){var c=this,b;c.owner=a.owner;c.module=a.module;b=Ext.apply({width:550,minWidth:550,height:200,minHeight:200,minimizable:false,maximizable:false,showHelp:false,closable:false,dsmStyle:"v5",items:[{xtype:"syno_formpanel",border:false,items:[{xtype:"syno_displayfield",value:_T("volume","ebox_space_crash_disk_enough_desc")}]}],buttons:[{xtype:"syno_button",text:_T("volume","volume_scan_reboot_immediately"),btnStyle:"blue",id:c.rebootButtonID=Ext.id(),handler:c.onReboot,scope:c},{xtype:"syno_button",text:_T("volume","volume_scan_reboot_later"),id:c.rebootLaterButtonID=Ext.id(),handler:c.onRebootLater,scope:c},{xtype:"syno_button",text:_T("common","alt_ignore"),id:c.ignoreButtonID=Ext.id(),handler:c.onIgnore,scope:c}]},a);c.callParent([b]);c.mon(c,"beforeclose",c.onBeforeClose,c,{single:true})},onBeforeClose:function(){var a=this;a.hide();return false},onReboot:function(){var a=this;SYNO.SDS.System.Reboot();a.hide()},onRebootLater:function(){var a=this;a.hide()},onIgnore:function(){var a=this;a.onRemoveTouchedFile();a.hide()},onRemoveTouchedFile:function(){var a=this;a.setStatusBusy();a.sendWebAPI({api:"SYNO.Storage.CGI.Check",method:"ignore_ebox_reassemble_notification",version:1,scope:a,callback:function(c,b){a.clearStatusBusy();if(!c){a.setStatusError()}}})}});